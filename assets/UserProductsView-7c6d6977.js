import{d as I,B as A,r as $,a as i,c as l,g as t,t as d,u as e,e as M,D as F,E as N,G as D,H,s as C,o as O,I as R,J as S,K as j,F as V,L as z,k,j as K,M as q}from"./index-ee97a360.js";import{u as G}from"./useModal-9c3760d6.js";import{_ as J}from"./PaginationComponent.vue_vue_type_style_index_0_lang-ae8ae63b.js";import{a as B,u as Q}from"./cartStore-6c47c9c4.js";const X={class:"modal-dialog modal-xl",role:"document"},W={class:"modal-content border-0"},Y={class:"modal-header bg-dark text-white"},Z={id:"findMoreModalLabel",class:"modal-title"},tt={class:"modal-body"},et={class:"row"},ot={class:"col-sm-6"},st=["src"],nt={class:"col-sm-6"},at={class:"badge bg-primary rounded-pill"},it={key:0,class:"h5"},lt={key:1},dt={class:"h6"},rt={class:"h5"},ct={class:"input-group"},ut=I({__name:"UserFindMoreModal",props:{tempProduct:null,addToCart:{type:Function}},setup(g,{expose:m}){const o=A(g,"tempProduct"),c=$(""),{showModal:h,hideModal:r}=G(c);let a=1;const u=()=>{a=1};return m({showModal:h,hideModal:r}),(_,s)=>{var f;return i(),l("div",{id:"findMoreModal",ref_key:"findMoreModalRef",ref:c,class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"findMoreModalLabel","aria-hidden":"true"},[t("div",X,[t("div",W,[t("div",Y,[t("h5",Z,[t("span",null,d(e(o).title),1)]),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close",onClick:s[0]||(s[0]=(...p)=>e(r)&&e(r)(...p))})]),t("div",tt,[t("div",et,[t("div",ot,[e(o).imagesUrl?(i(),l("img",{key:0,class:"img-fluid",src:(f=e(o))==null?void 0:f.imagesUrl[0],alt:""},null,8,st)):M("",!0)]),t("div",nt,[t("span",at,d(e(o).category),1),t("p",null,"商品描述："+d(e(o).description),1),t("p",null,"商品內容："+d(e(o).content),1),e(o).price<e(o).origin_price?(i(),l("div",it,d(e(o).origin_price)+" 元 ",1)):(i(),l("div",lt,[t("del",dt,"原價 "+d(e(o).origin_price)+" 元",1),t("div",rt,"現在只要 "+d(e(o).price)+" 元",1)])),t("div",null,[t("div",ct,[F(t("input",{"onUpdate:modelValue":s[1]||(s[1]=p=>D(a)?a.value=p:a=p),min:"1",type:"number",class:"form-control"},null,512),[[N,e(a),void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:s[2]||(s[2]=p=>(g.addToCart(e(o).id,e(a)),u(),e(r)()))}," 加入購物車 ")])])])])])])])],512)}}}),{VITE_URL:U,VITE_PATH:w}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"tuhacrt",VITE_TOKEN:"loginToken",VITE_TEXT:"Environment is in production build",BASE_URL:"/VL_CC/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},_t=H("product",()=>{const g=$({products:[],pagination:{}}),m=$({imagesUrl:[]}),b=B(),{isLoading:o}=C(b),c=async(r=(a=>(a=g.value)==null?void 0:a.pagination.current_page)()||1)=>{var _;const u=`${U}/api/${w}/products?page=${r}`;o.value=!0;try{const s=await R.get(u);o.value=!1,g.value=s.data}catch(s){o.value=!1,s instanceof S&&alert((_=s.response)==null?void 0:_.data.message)}},h=async r=>{var _;const{id:a}=r,u=`${U}/api/${w}/product/${a}`;o.value=!0;try{await R.get(u),o.value=!1,j.push(`/product/${a}`)}catch(s){o.value=!1,s instanceof S&&alert((_=s.response)==null?void 0:_.data.message)}};return O(()=>{c()}),{products:g,tempProduct:m,getProductList:c,gotToProduct:h}}),pt={class:"container"},gt={class:"mt-4"},mt={class:"table align-middle"},ht=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),bt={key:0},ft={style:{width:"200px"}},vt={key:0},yt={class:"h6"},$t={class:"h5"},kt={key:1,class:"h5"},Mt={class:"btn-group btn-group-sm"},Ct=["disabled","onClick"],Tt=["disabled","onClick"],Et=["disabled","onClick"],Lt={class:"d-flex justify-content-center"},Vt=I({__name:"UserProductsView",setup(g){const m=$(),b=B(),{isLoading:o}=C(b),c=_t(),{getProductList:h,gotToProduct:r}=c,{products:a,tempProduct:u}=C(c),_=Q(),{addToCart:s}=_,f=(p,v)=>{var y;switch(p){case"findMore":u.value={...v},(y=m.value)==null||y.showModal();break}};return(p,v)=>{var T,E,L,P;const y=K("Loading");return i(),l(V,null,[t("div",pt,[t("div",gt,[t("table",mt,[ht,(E=(T=e(a))==null?void 0:T.products)!=null&&E.length?(i(),l("tbody",bt,[(i(!0),l(V,null,z((L=e(a))==null?void 0:L.products,n=>(i(),l("tr",{key:n.id},[t("td",ft,[n.imagesUrl?(i(),l("div",{key:0,style:q([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${n==null?void 0:n.imagesUrl[0]})`}])},null,4)):M("",!0)]),t("td",null,d(n.title),1),t("td",null,[n.price<n.origin_price?(i(),l("div",vt,[t("del",yt,"原價 "+d(n.origin_price)+" 元",1),t("div",$t,d(n.price)+" 元",1)])):(i(),l("div",kt,d(n.origin_price)+" 元",1))]),t("td",null,[t("div",Mt,[t("button",{type:"button",class:"btn btn-outline-secondary",disabled:e(o),onClick:x=>e(r)(n)}," 詳細希望 ",8,Ct),t("button",{type:"button",class:"btn btn-outline-secondary",disabled:e(o),onClick:x=>f("findMore",n)}," 查看更多 ",8,Tt),t("button",{type:"button",class:"btn btn-outline-danger",disabled:e(o),onClick:x=>e(s)(n.id)}," 加到購物車 ",8,Et)])])]))),128))])):M("",!0)])]),t("div",Lt,[k(J,{ref:"paginationComponentRef",pagination:(P=e(a))==null?void 0:P.pagination,onChangePage:e(h)},null,8,["pagination","onChangePage"])])]),k(ut,{ref_key:"findMoreModalRef",ref:m,"temp-product":e(u),"add-to-cart":e(s)},null,8,["temp-product","add-to-cart"]),k(y,{active:e(o),"onUpdate:active":v[0]||(v[0]=n=>D(o)?o.value=n:null),"can-cancel":!0,"is-full-page":!0},null,8,["active"])],64)}}});export{Vt as default};
