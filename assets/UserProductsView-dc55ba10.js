import{d as E,B as R,r as x,a as d,c as l,g as t,t as r,u as s,e as $,D as V,E as U,G as w,h as P,o as I,F as C,H as D,k as y,i as S,I as L,J as T,j as A,K as B}from"./index-ee626469.js";import{u as F}from"./useModal-2211ba4f.js";import{_ as N}from"./PaginationComponent.vue_vue_type_style_index_0_lang-fcdce101.js";import{u as H}from"./cartStore-6a32536c.js";const O={class:"modal-dialog modal-xl",role:"document"},j={class:"modal-content border-0"},z={class:"modal-header bg-dark text-white"},K={id:"findMoreModalLabel",class:"modal-title"},q={class:"modal-body"},G={class:"row"},J={class:"col-sm-6"},Q=["src"],X={class:"col-sm-6"},W={class:"badge bg-primary rounded-pill"},Y={key:0,class:"h5"},Z={key:1},tt={class:"h6"},et={class:"h5"},ot={class:"input-group"},st=E({__name:"UserFindMoreModal",props:{tempProduct:null,addToCart:{type:Function}},setup(f,{expose:g}){const i=R(f,"tempProduct"),m=x(""),{showModal:h,hideModal:p}=F(m);let e=1;const b=()=>{e=1};return g({showModal:h,hideModal:p}),(k,_)=>{var c;return d(),l("div",{id:"findMoreModal",ref_key:"findMoreModalRef",ref:m,class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"findMoreModalLabel","aria-hidden":"true"},[t("div",O,[t("div",j,[t("div",z,[t("h5",K,[t("span",null,r(s(i).title),1)]),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close",onClick:_[0]||(_[0]=(...n)=>s(p)&&s(p)(...n))})]),t("div",q,[t("div",G,[t("div",J,[s(i).imagesUrl?(d(),l("img",{key:0,class:"img-fluid",src:(c=s(i))==null?void 0:c.imagesUrl[0],alt:""},null,8,Q)):$("",!0)]),t("div",X,[t("span",W,r(s(i).category),1),t("p",null,"商品描述："+r(s(i).description),1),t("p",null,"商品內容："+r(s(i).content),1),s(i).price<s(i).origin_price?(d(),l("div",Y,r(s(i).origin_price)+" 元 ",1)):(d(),l("div",Z,[t("del",tt,"原價 "+r(s(i).origin_price)+" 元",1),t("div",et,"現在只要 "+r(s(i).price)+" 元",1)])),t("div",null,[t("div",ot,[V(t("input",{"onUpdate:modelValue":_[1]||(_[1]=n=>w(e)?e.value=n:e=n),min:"1",type:"number",class:"form-control"},null,512),[[U,s(e),void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:_[2]||(_[2]=n=>(f.addToCart(s(i).id,s(e)),b()))}," 加入購物車 ")])])])])])])])],512)}}}),nt={class:"container"},it={class:"mt-4"},at={class:"table align-middle"},dt=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),lt={key:0},rt={style:{width:"200px"}},ct={key:0},ut={class:"h6"},_t={class:"h5"},pt={key:1,class:"h5"},gt={class:"btn-group btn-group-sm"},mt=["disabled","onClick"],ht=["disabled","onClick"],bt=["disabled","onClick"],ft={class:"d-flex justify-content-center"},Mt=E({__name:"UserProductsView",setup(f){const{VITE_URL:g,VITE_PATH:v}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"tuhacrt",VITE_TOKEN:"loginToken",VITE_TEXT:"Environment is in production build",BASE_URL:"/VL_CC/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},i=S(),m=H(),{addToCart:h}=m,p=x(),e=P({products:[],pagination:{},tempProduct:{imagesUrl:[]},isLoading:!1}),b=async(c=e.pagination.current_page||1)=>{var u;const n=`${g}/api/${v}/products?page=${c}`;e.isLoading=!0;try{const a=await L.get(n);e.isLoading=!1,e.products=a.data.products,e.pagination=a.data.pagination}catch(a){a instanceof T&&alert((u=a.response)==null?void 0:u.data.message)}};I(()=>{b()});const k=(c,n)=>{var u;switch(c){case"findMore":e.tempProduct={...n},(u=p.value)==null||u.showModal();break}},_=async c=>{var a;const{id:n}=c,u=`${g}/api/${v}/product/${n}`;e.tempProduct={...c},e.isLoading=!0;try{await L.get(u),e.isLoading=!1,i.push(`/product/${n}`)}catch(o){o instanceof T&&alert((a=o.response)==null?void 0:a.data.message)}};return(c,n)=>{var a;const u=A("Loading");return d(),l(C,null,[t("div",nt,[t("div",it,[t("table",at,[dt,(a=e.products)!=null&&a.length?(d(),l("tbody",lt,[(d(!0),l(C,null,D(e==null?void 0:e.products,o=>(d(),l("tr",{key:o.id},[t("td",rt,[o.imagesUrl?(d(),l("div",{key:0,style:B([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o==null?void 0:o.imagesUrl[0]})`}])},null,4)):$("",!0)]),t("td",null,r(o.title),1),t("td",null,[o.price<o.origin_price?(d(),l("div",ct,[t("del",ut,"原價 "+r(o.origin_price)+" 元",1),t("div",_t,r(o.price)+" 元",1)])):(d(),l("div",pt,r(o.origin_price)+" 元",1))]),t("td",null,[t("div",gt,[t("button",{type:"button",class:"btn btn-outline-secondary",disabled:e.isLoading,onClick:M=>_(o)}," 詳細希望 ",8,mt),t("button",{type:"button",class:"btn btn-outline-secondary",disabled:e.isLoading,onClick:M=>k("findMore",o)}," 查看更多 ",8,ht),t("button",{type:"button",class:"btn btn-outline-danger",disabled:e.isLoading,onClick:M=>s(h)(o.id)}," 加到購物車 ",8,bt)])])]))),128))])):$("",!0)])]),t("div",ft,[y(N,{ref:"paginationComponentRef",pagination:e.pagination,onChangePage:b},null,8,["pagination"])])]),y(st,{ref_key:"findMoreModalRef",ref:p,"temp-product":e.tempProduct,"add-to-cart":s(h)},null,8,["temp-product","add-to-cart"]),y(u,{active:e.isLoading,"onUpdate:active":n[0]||(n[0]=o=>e.isLoading=o),"can-cancel":!0,"is-full-page":!0},null,8,["active"])],64)}}});export{Mt as default};
